;;; Code for Advent of Code 2021, Day 16.
;;;
;;; Code author: Russell A. Edson
;;; Date last modified: 16/12/2021

;;; Problem 1
;; For our puzzle input we are given a string of hexadecimal digits,
;; which we'll read in:
(ql:quickload '(:uiop :str :alexandria))
(defparameter hexadecimal
  (car (uiop:read-file-lines "day16_problem1.txt")))

;; We want to convert between hexadecimal and binary, so we can
;; define some functions that let us do this conversion:
(defun hexadecimal->binary (number)
  "Convert the given hexadecimal NUMBER string to binary."
  (format nil
	  "狺祜镳骘桢徜邈轫犰轭篝蚝箴扉铛礅弪猴黹舡铛祆舂泔祆邈ㄦ矧磲铋船О洧疳蝮瀛轭翦珏黩轸瀛麸篝蜷铉疳蝮瀛轭翦珏桢徜邈轫犰候徜轼倍衡狍博┅┅ㄤ彐躅忾钺蝙捐屮徜邈轫犰铛礅弪⒚镱鲥螋翳玳鲥忾钺蝙握吐乓篝蜷铉麸桢徜邈轫犰黩轸瀛麸篝蜷铉疳蝮瀛轭翦珏铛礅弪候徜轼博衡狍倍┅ㄨ屮徜邈轫犰锯轭狎⒐徭换骄⒈鞍北氨氨北雹ㄨ屮徜邈轫犰锯轭狎⒈北换骄鞍氨鞍氨鞍氨ㄢ轭狎捐屮徜邈轫犰⒈卑鞍氨鞍卑鞍鞍鞍雹换骄⒊肮氨换物麇狎玳鲥翳狒翳桢徜邈轫犰篝蜷铉轭瘐蝈痱弩孱趔换疳汶弭痫篌殁禊鏖翳趄衢扉铉弪矬┈麒殂磲泔铘衢换雉桢疳汶弭蟋犷弼弪疳汶弭栳桢徜弪翳狒箴邈殒殄换翳鲥蝮轱轭忾趔翳孱翳疳汶弭豉疱赡轭忾趔犷换翳孱翳疳祜徜语麇汜溴骈铄骢钽糸镱翳狒疱蜴矧眢翳轶换箴扉趑轭翳狒麇汜躞蝈沲蝮轹屐骘篚怵徙脲趔┖ㄤ彐躅疳汶弭ㄢ轭狎⒁弭躜痨轶疳蝮轭翳玳鲥律瘟屹篝蜷铉轭麸疳汶弭骘蝽戾è鲥蝮轱疳蝮瀛轭翦珏篝蚝篚怏趄轭忾钺蝙候徜轼博豉疱殇疳蝮瀛轭翦珏篝蚝篚怏趄轭忾钺蝙候徜轼博疳祜徜篝蚝篚怏趄轭戾铉翳忾钺蝙忾钺蝙┅扉篝忽弪箝镱鲥蝮轱呼疱殇豉疱殇吼狴祜徜疳祜徜┅疳汶弭ㄨ屮徜邈轫犰锯轭狎⒛财挪涪┅换骄ê峙矣上涸傩怒赡盒临滔聊⒈氨北北北鞍氨氨鞍阿换物篚痧矬秕疳汶弭蝈痱弩孱翦扉翦蜥ㄩ瀹鏖翳换豉疱殇镦春ㄤ彐躅扉翦蜥炜疳汶弭⒃蝓殒翳玳鲥辛盟旁孱泔溴忾钺蝙扉翦蜥飚ㄥ聃犰ㄧ弭疳汶弭呼疱殇穿换骑扉翦蜥飕麇怛遽翳疳祜徜躔轭麸珧秕痼镦换ㄩ珙矧轭趄衢扉铉弪矬┈麒弪遽汨珧秕镦骈鲥忾趔换轶镦翳骘蝽换换麒弪轶骒徵骘麒弭桢翳轶轶翳灬篝痖邈镦翳换扉翦蜥矧铒ㄆ奖礤犷轸轶犷轭翦蝽邃獒翦珧秕瓞平换礤犷轸轶翳灬篝珧秕皓犷翳蝈篝镦翳忾趔骘蝽换翳铛礅弪换换娱钽翳扉翦蜥篝镳狍箫镱狍麇箦弪轭翳骒徵换麇ъ蝈趱蝾翳蝈篝镦翳忾钺蝙篝蜷铉狍犷徜溟糸镱犰换秕麴豸牾篝轭汜箦ㄤ彐躅疳蝮瀛扉翦蜥疳祜徜⒁弭躜翳溴汩磲蝈痱弩孱翎糸镱镦玳鲥扉翦蜥辛偬狭漠戾è忾钺蝙铋飑ㄩ钿屮癌ㄧ蝻躔铋飑祜镳骘ㄢ獠獬獯獾镱篝蚝箴扉疳祜徜猴黹舡铛祆舂怡灬礅溽扉篝铘桡潋扉篝┅麒孱铒铛祆獾┅滹箦翩珧秕痼ㄡ痧孱珧秕痼扉篝扉篝獗ㄦ矧磲铋狺扉篝獠獬獯獾┅┅┅祜镳钺礤犴犰玑磲翦珧秕痼骘ㄦ灬忾趔轭珧秕痼滹箦翩轭溴ǐ轭溴旦箦翩忾钺蝙ㄡ痧孱忾钺蝙扉篝忾趔┅ㄩㄥ聃犰骒徵阿蝈趱蝾骝镯犴犰玑磲翦珧秕痼┅箦翩忾钺蝙ㄦ矧磲铋狺忾钺蝙┅鲠祯弩疳蝮瀛轭翦珏忾钺蝙候徜轼博篝蚝篚怏趄轭轭溴戾铉翳疳祜徜疳祜徜┅┅疳蝮瀛扉翦蜥⒈氨北北北鞍氨氨鞍阿换骄舶脖换骄鞍阿换令箫珏铄蜥ю狎箦骢钽糸镱麸镳弪狒镱珏铄蜥换疳汶弭镱禊栳戽轫痨屙孱翦箫驷颟黹玷祜镫扉脲翳轶ㄤ彐躅疳蝮疳汶弭⒁弭躜翳疳蝮邃辛盟旁篝蝓泗躜瀣犰镱鏖翳犷屮沐篌忾趔戾è疳汶弭ㄣ镳箦疳汶弭┅眭祠轲戾鲠祯瀛忾钿篝蝓泗躜屮沐篌ㄣ镱è扉翦蜥炜疳汶弭疳蝮瀛扉翦蜥ㄧ弭疳汶弭吼狴祜徜┅鲠祯弩ㄧ弭疳汶弭吼狴祜徜┅箦翩ㄧ弭疳汶弭吼狴祜徜篝蝓泗躜濠鲠祯弩疳汶弭屮沐篌┅┅疳蝮疳汶弭ㄨ屮徜邈轫犰锯轭狎⒛财挪涪┅换骄ê峙矣上涸傩怒赡盒临滔聊舶脖换骄鞍阿疳蝮疳汶弭ㄨ屮徜邈轫犰锯轭狎⒊赴岸拼挡贡舶阿┅换骄ê峙矣上涸傩怒赡盒临滔聊换骄鞍鞍鞍鞍鞍氨卑北北氨鞍氨氨鞍卑卑氨鞍氨鞍卑鞍鞍鞍鞍换骄换碰弪雉桢疳汶弭豉疱轶犷镳弪狒矧骘麒殂麇狎玳鲥ㄩ换翳轶骈蝮疳螋翳狒翳疳祜徜翳孱栳翳骘蝽换ū杯钡忾趔换麒弪轶翳戾铉翳豉疱赡篚汨翳狒换探礤犷翳铄钡忾趔箴邈殒翳麸翎忾舡戾铉翳骘翳换篚怵徙脲趔麒殂篝狎轫礤溟狒屐徭翦蝼狎洮换探礤犷翳铄北忾趔箴邈殒翳麸翎铛礅弪镦篚怵徙脲趔换泔铘衢铄轭翳轶疳汶弭麒殂犰箫篝狎轫礤溟狒屐徭翦蝼狎洚ㄤ彐躅镳弪狒矧疳汶弭⒃蝓殒翳玳鲥辛盟旁孱泔溴犷镳弪狒矧铒ㄥ聃犰ㄧ弭疳汶弭呼疱殇穿┅ㄤ彐躅疳蝮瀛镳弪狒矧疳祜徜⒁弭躜翳疳蝮邃镳弪狒矧辛偬狭ㄩ钽祯溟铉篚怵徙脲趔┊戾舄è疳蝮邃疳祜徜铋飑戾铉翳豉疱殇篝蚝篚怏趄轭疳祜徜┅戾铉翳箝ㄩㄥ聃犰戾铉翳豉疱殇阿钡北┅ㄩ钿屮ū戾铉翳箝濠戾铉翳忾趔篝蚝篚怏趄轭轭溴疳祜徜┅蝈篝镦疳祜徜篝蚝篚怏趄轭轭溴戾铉翳疳祜徜疳祜徜┅换涉翳戾铉翳豉疱殇轶艾麇狎玳鲥翳麸翎戾铉翳换镦翳篚猸疳汶弭螽ㄩㄥ聃犰戾铉翳豉疱殇阿戾è麸翎飙篚怵徙脲舡忾趔疳蝮瀛轭翦珏戾铉翳忾趔候徜轼博┅箦翩轭溴癌祜镳麒殪轭溴麸翎飙篚怵徙脲舡忾趔滹眭祠轲戾鲠祯瀛忾钿篚怵徙脲蝈篝疳蝮疳汶弭蝈篝镦疳祜徜┅箦翩疳蝮邃疳祜徜ㄡ痧孱疳蝮邃疳祜徜扉篝篚怵徙脲舂┅箦翩轭溴ǐ轭溴ō戾铉翳蝈篝镦疳祜徜戾铉翳蝈篝┅┅箦翩蝈篝镦疳祜徜蝈篝┅┅换萧桢蝼轶瀣麇狎麸熹栾磲铢篚怵徙脲趔狎轭沆蹁邃戾è篚怵徙脲舡泔躅癌麸翎飙篚怵徙脲趔疳蝮瀛轭翦珏戾铉翳忾趔候徜轼博┅祜镳麒殪篚怵徙脲舡泔躅麸翎飙篚怵徙脲趔滹眭祠轲戾鲠祯瀛忾钿篚怵徙脲蝈篝疳蝮疳汶弭蝈篝镦疳祜徜┅箦翩疳蝮邃疳祜徜ㄡ痧孱疳蝮邃疳祜徜扉篝篚怵徙脲舂┅ㄩ钽篚怵徙脲舡泔躅舂箦翩蝈篝镦疳祜徜蝈篝┅┅鲠祯弩疳蝮邃疳祜徜蝈篝镦疳祜徜┅换物麇蝈溴骈铄秕疳蝮骢钽糸镱犷徜犷徜溟糸镱犰换沆狨箦麸徙泔躅骘镳弪狒矧疳汶弭蟋犷弼弪翳轭磲玳汜祆换黠螂螽ㄤ彐躅疳蝮疳汶弭⒁弭躜翳疳蝮邃辛盟旁篝蝓泗躜瀣犰镱鏖翳犷屮沐篌忾趔戾è疳汶弭ㄣ镳箦疳汶弭┅眭祠轲戾鲠祯瀛忾钿篝蝓泗躜屮沐篌ㄣ镱è扉翦蜥炜疳汶弭疳蝮瀛扉翦蜥ㄧ弭疳汶弭吼狴祜徜┅è镳弪狒矧疳汶弭疳蝮瀛镳弪狒矧ㄧ弭疳汶弭吼狴祜徜┅鲠祯弩ㄧ弭疳汶弭吼狴祜徜┅箦翩ㄧ弭疳汶弭吼狴祜徜篝蝓泗躜濠鲠祯弩疳汶弭屮沐篌┅┅疳蝮疳汶弭ㄨ屮徜邈轫犰锯轭狎⒊赴岸拼挡贡舶阿┅换骄ê峙矣上涸傩怒赡盒临滔聊换骄è褐乓由衔涸傩怒赡盒临滔聊卑ê峙矣上涸傩怒赡盒临滔聊舶┅换骄鞍鞍鞍阿疳蝮疳汶弭ㄨ屮徜邈轫犰锯轭狎⑴虐澳窗酶渤岸阿┅换骄ê峙矣上涸傩怒赡盒临滔聊换骄è褐乓由衔涸傩怒赡盒临滔聊暴ê峙矣上涸傩怒赡盒临滔聊博换骄ê峙矣上涸傩怒赡盒临滔聊畅┅换骄鞍鞍阿换语狒翳轶痫轭麇汜疳蝮秕孱糸蝈玳鲥轭瘐桢徜邈轫犰麸换躅泔鲥翳疳汶弭栝弪狎汨篝蝓泗躜瀹ㄤ彐疳蜥礤翦轭瘐舡疳汶弭疳蝮疳汶弭ㄨ屮徜邈轫犰锯轭狎桢徜邈轫犰┅┅换令骘疳螋麇箝眇禊麽铘麸祜镳秭弪翳孱糸蝈篝蝓泗躜换犷篚躔翳鲥蝮轱铛礅弪螽祜镳骘脲鲠祯濠镱ㄡ戾犷潋獒烘灬趑孱轭瘐舡疳汶弭麒孱ㄥ聃犰脲忽弪箝镱篚鲠祯濠换序镡戾换物麇狎玳鲥翳豉疱徙泔蜾轭麸翳豉疱殇箫麇汜换溴骈铄ㄡ鲥蝙涕箴々у鲠歆篝戾骢钽糸镱骘秕疳汶弭换篝蝓泗躜瀹ㄤ彐躅弼犰疳汶弭疳汶弭⑴鲠祯狒翳鲠祯镦翳玳鲥辛盟旁ㄣ镱è羼踽祓ㄧ弭疳汶弭呼疱殇癌蝈漉沐＇磲疸狎＇弼犰疳汶弭ㄧ弭疳汶弭吼狴祜徜┅┅è羼踽祓ㄧ弭疳汶弭呼疱殇暴蝈漉沐＇磲疸狎＇弼犰疳汶弭ㄧ弭疳汶弭吼狴祜徜┅┅è羼踽祓ㄧ弭疳汶弭呼疱殇博ㄡ痧禊＇黹磲疸狎＇弼犰疳汶弭ㄧ弭疳汶弭吼狴祜徜┅┅è羼踽祓ㄧ弭疳汶弭呼疱殇畅ㄡ痧禊＇磲磲疸狎＇弼犰疳汶弭ㄧ弭疳汶弭吼狴祜徜┅┅è羼踽祓ㄧ弭疳汶弭呼疱殇穿ㄧ弭疳汶弭吼狴祜徜┅è羼踽祓ㄧ弭疳汶弭呼疱殇旦ㄩㄥ鲠飙疳汶弭ㄣ狎ㄧ弭疳汶弭吼狴祜徜┅ㄥ鲠飙疳汶弭ㄣ徜ㄧ弭疳汶弭吼狴祜徜┅┅癌è羼踽祓ㄧ弭疳汶弭呼疱殇订ㄩㄥ鲠飙疳汶弭ㄣ狎ㄧ弭疳汶弭吼狴祜徜┅ㄥ鲠飙疳汶弭ㄣ徜ㄧ弭疳汶弭吼狴祜徜┅┅癌è羼踽祓ㄧ弭疳汶弭呼疱殇珐ㄩㄥ鲠飙疳汶弭ㄣ狎ㄧ弭疳汶弭吼狴祜徜┅ㄥ鲠飙疳汶弭ㄣ徜ㄧ弭疳汶弭吼狴祜徜┅┅癌疳篌┅ㄥ鲠飙疳汶弭疳蝮疳汶弭ㄨ屮徜邈轫犰锯轭狎⒚舶奥窗粮并┅┅换骄换语麇箝眇禊弼犰踽翦翳孱糸蝈疳汶弭篝蝓泗躜瀹ㄥ鲠飙疳汶弭轭瘐舡疳汶弭换骄辈洞傅反撤舶